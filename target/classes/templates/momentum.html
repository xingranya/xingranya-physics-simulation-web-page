<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>动量守恒实验</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        :root {
            /* MD3 颜色系统 - Light主题 */
            --md-sys-color-primary: #6750A4;
            --md-sys-color-on-primary: #FFFFFF;
            --md-sys-color-primary-container: #EADDFF;
            --md-sys-color-on-primary-container: #21005E;
            --md-sys-color-secondary: #625B71;
            --md-sys-color-on-secondary: #FFFFFF;
            --md-sys-color-secondary-container: #E8DEF8;
            --md-sys-color-on-secondary-container: #1E192B;
            --md-sys-color-tertiary: #7D5260;
            --md-sys-color-on-tertiary: #FFFFFF;
            --md-sys-color-tertiary-container: #FFD8E4;
            --md-sys-color-on-tertiary-container: #370B1E;
            --md-sys-color-error: #B3261E;
            --md-sys-color-on-error: #FFFFFF;
            --md-sys-color-error-container: #F9DEDC;
            --md-sys-color-on-error-container: #370B1E;
            --md-sys-color-background: #FFFBFE;
            --md-sys-color-on-background: #1C1B1F;
            --md-sys-color-surface: #FFFBFE;
            --md-sys-color-on-surface: #1C1B1F;
            --md-sys-color-surface-variant: #E7E0EC;
            --md-sys-color-on-surface-variant: #49454F;
            --md-sys-color-outline: #79747E;
            
            /* 圆角 */
            --md-sys-shape-corner-small: 8px;
            --md-sys-shape-corner-medium: 12px;
            --md-sys-shape-corner-large: 16px;
            --md-sys-shape-corner-extra-large: 28px;
            
            /* 阴影 */
            --md-sys-elevation-1: 0 1px 2px rgba(0,0,0,0.3), 0 1px 3px 1px rgba(0,0,0,0.15);
            --md-sys-elevation-2: 0 1px 2px rgba(0,0,0,0.3), 0 2px 6px 2px rgba(0,0,0,0.15);
            --md-sys-elevation-3: 0 4px 8px 3px rgba(0,0,0,0.15), 0 1px 3px rgba(0,0,0,0.3);
        }
        
        body {
            font-family: 'Roboto', sans-serif;
            background-color: var(--md-sys-color-background);
            color: var(--md-sys-color-on-background);
            margin: 0;
            padding: 0;
        }
        
        .container {
            max-width: 1000px;
            padding-top: 2rem;
            padding-bottom: 2rem;
        }
        
        h1 {
            color: var(--md-sys-color-primary);
            font-weight: 500;
            font-size: 2.25rem;
            margin-bottom: 1.5rem;
        }
        
        h3 {
            color: var(--md-sys-color-primary);
            font-weight: 500;
            font-size: 1.5rem;
            margin-bottom: 1rem;
        }
        
        .md3-card {
            background-color: var(--md-sys-color-surface);
            border-radius: var(--md-sys-shape-corner-large);
            box-shadow: var(--md-sys-elevation-1);
            border: none;
            overflow: hidden;
            height: 100%;
            margin-bottom: 1.5rem;
        }
        
        .md3-card-body {
            padding: 1.5rem;
        }
        
        canvas {
            border-radius: var(--md-sys-shape-corner-medium);
            border: 1px solid var(--md-sys-color-outline);
            background-color: var(--md-sys-color-surface-variant);
            margin-bottom: 1.5rem;
        }
        
        .md3-form-field {
            margin-bottom: 1.25rem;
        }
        
        .md3-form-field label {
            color: var(--md-sys-color-on-surface-variant);
            font-size: 0.875rem;
            margin-bottom: 0.5rem;
            display: block;
        }
        
        .md3-input {
            background-color: var(--md-sys-color-surface-variant);
            border: none;
            border-radius: var(--md-sys-shape-corner-small);
            padding: 0.75rem 1rem;
            width: 100%;
            font-size: 1rem;
            color: var(--md-sys-color-on-surface);
            transition: box-shadow 0.2s;
        }
        
        .md3-input:focus {
            outline: none;
            box-shadow: 0 0 0 2px var(--md-sys-color-primary);
        }
        
        .md3-btn {
            display: inline-block;
            height: 40px;
            padding: 0 24px;
            border-radius: 20px;
            font-size: 0.875rem;
            font-weight: 500;
            letter-spacing: 0.1px;
            text-transform: uppercase;
            line-height: 40px;
            cursor: pointer;
            text-decoration: none;
            text-align: center;
            transition: background-color 0.2s;
            border: none;
        }
        
        .md3-btn-primary {
            background-color: var(--md-sys-color-primary);
            color: var(--md-sys-color-on-primary);
        }
        
        .md3-btn-primary:hover {
            background-color: var(--md-sys-color-primary);
            opacity: 0.9;
            color: var(--md-sys-color-on-primary);
        }
        
        .md3-btn-secondary {
            background-color: var(--md-sys-color-secondary-container);
            color: var(--md-sys-color-on-secondary-container);
            margin-right: 8px;
        }
        
        .md3-btn-secondary:hover {
            background-color: var(--md-sys-color-secondary-container);
            opacity: 0.9;
            color: var(--md-sys-color-on-secondary-container);
        }
        
        .result {
            background-color: var(--md-sys-color-primary-container);
            color: var(--md-sys-color-on-primary-container);
            border-radius: var(--md-sys-shape-corner-large);
            padding: 1.5rem;
            margin-top: 1rem;
        }
        
        .highlight-value {
            font-weight: 500;
            color: var(--md-sys-color-primary);
        }
    </style>
</head>
<body>
    <div class="container">
        <h1 class="text-center">动量守恒实验</h1>
        
        <div class="row">
            <div class="col-md-6">
                <div class="md3-card">
                    <div class="md3-card-body">
                        <form action="/calculateMomentum" method="post">
                            <div class="md3-form-field">
                                <label for="mass1">物体1质量 (kg)</label>
                                <input type="number" class="md3-input" id="mass1" name="mass1" step="0.1" th:value="${mass1}" required>
                            </div>
                            
                            <div class="md3-form-field">
                                <label for="velocity1">物体1初速度 (m/s)</label>
                                <input type="number" class="md3-input" id="velocity1" name="velocity1" step="0.1" th:value="${velocity1}" required>
                            </div>
                            
                            <div class="md3-form-field">
                                <label for="mass2">物体2质量 (kg)</label>
                                <input type="number" class="md3-input" id="mass2" name="mass2" step="0.1" th:value="${mass2}" required>
                            </div>
                            
                            <div class="md3-form-field">
                                <label for="velocity2">物体2初速度 (m/s)</label>
                                <input type="number" class="md3-input" id="velocity2" name="velocity2" step="0.1" th:value="${velocity2}" required>
                            </div>
                            
                            <button type="submit" class="md3-btn md3-btn-primary w-100">计算碰撞结果</button>
                        </form>
                    </div>
                </div>
            </div>
            
            <div class="col-md-6">
                <div class="md3-card h-100">
                    <div class="md3-card-body">
                        <canvas id="simulationCanvas" width="400" height="250"></canvas>
                        
                        <div class="result" th:if="${finalVelocity1 != null}">
                            <h3>计算结果</h3>
                            <p>碰撞前总动量：<span class="highlight-value" th:text="${mass1 * velocity1 + mass2 * velocity2}">0</span> kg⋅m/s</p>
                            <p>碰撞后总动量：<span class="highlight-value" th:text="${mass1 * finalVelocity1 + mass2 * finalVelocity2}">0</span> kg⋅m/s</p>
                            <p>物体1碰撞后速度：<span class="highlight-value" th:text="${finalVelocity1}">0</span> m/s</p>
                            <p>物体2碰撞后速度：<span class="highlight-value" th:text="${finalVelocity2}">0</span> m/s</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="text-center mt-4">
            <a href="/momentum-intro" class="md3-btn md3-btn-secondary">返回说明</a>
            <a href="/" class="md3-btn md3-btn-secondary">返回首页</a>
        </div>
    </div>

    <script>
        // 获取画布和上下文
        const canvas = document.getElementById('simulationCanvas');
        const ctx = canvas.getContext('2d');
        
        // 定义小球的初始位置和大小
        const ball1 = {
            x: 100,
            y: 120,
            radius: 20,
            color: '#6750A4' // 使用主题色
        };
        
        const ball2 = {
            x: 300,
            y: 120,
            radius: 20,
            color: '#7D5260' // 使用第三色
        };
        
        // 绘制函数
        function draw() {
            // 清空画布
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            
            // 绘制中心线
            ctx.beginPath();
            ctx.moveTo(0, canvas.height/2);
            ctx.lineTo(canvas.width, canvas.height/2);
            ctx.strokeStyle = '#E7E0EC';
            ctx.stroke();
            
            // 绘制小球1
            ctx.beginPath();
            ctx.arc(ball1.x, ball1.y, ball1.radius, 0, Math.PI * 2);
            ctx.fillStyle = ball1.color;
            ctx.fill();
            ctx.closePath();
            
            // 小球1标签
            ctx.fillStyle = '#FFFFFF';
            ctx.font = '14px Roboto';
            ctx.textAlign = 'center';
            ctx.textBaseline = 'middle';
            ctx.fillText('1', ball1.x, ball1.y);
            
            // 绘制小球2
            ctx.beginPath();
            ctx.arc(ball2.x, ball2.y, ball2.radius, 0, Math.PI * 2);
            ctx.fillStyle = ball2.color;
            ctx.fill();
            ctx.closePath();
            
            // 小球2标签
            ctx.fillStyle = '#FFFFFF';
            ctx.font = '14px Roboto';
            ctx.textAlign = 'center';
            ctx.textBaseline = 'middle';
            ctx.fillText('2', ball2.x, ball2.y);
        }
        
        // 初始绘制
        draw();
        
        // 如果有速度值，添加动画
        const velocity1 = document.getElementById('velocity1')?.value;
        const velocity2 = document.getElementById('velocity2')?.value;
        
        if (velocity1 && velocity2) {
            let time = 0;
            const animate = () => {
                time += 0.02;
                
                // 更新位置
                ball1.x += parseFloat(velocity1) * 0.5;
                ball2.x += parseFloat(velocity2) * 0.5;
                
                // 如果小球移出画布，重置位置
                if (ball1.x > canvas.width + ball1.radius || ball1.x < -ball1.radius) {
                    ball1.x = parseFloat(velocity1) > 0 ? -ball1.radius : canvas.width + ball1.radius;
                }
                if (ball2.x > canvas.width + ball2.radius || ball2.x < -ball2.radius) {
                    ball2.x = parseFloat(velocity2) > 0 ? -ball2.radius : canvas.width + ball2.radius;
                }
                
                draw();
                requestAnimationFrame(animate);
            };
            
            animate();
        }
    </script>
    
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html> 